---
title: "Ejercicio 2 Estadística Computacional"
author: "Joaquín Saldivia"
date: "2023-05-16"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(gtools)
```

### Ejercicio 2
¿En que se diferencian las permutaciones y combinaciones?

La diferencia entre estos dos radica en que en las permutaciones el orden es importante en los resultados, en cambio para las combinaciones no es importante el orden, tomando como un mismo resultado si sale un elemento primero o ultimo.

Las formulas que caracterizan a ambas son:

* #### Permutación
\[nP_r = \frac{n!}{(n-r)!}\]

* #### Combinación
\[nC_r = \frac{n!}{(n-r)!r!}\]

### Ejercicio 3
¿Que hacen las funciones combinations y permutations?

* Combinations: Esta función crea una matriz con las posibles combinaciones y se usa de la siguiente manera

```{r}
combinations(3, 2, v = 1:3)
```

donde 3 es el largo del vector de entrada, 2 es el largo del vector de salida y v es es el vector de entrada, ademas tiene configuraciones como set que indica si los duplicados se eliminan del vector de entrada, y repeats.allowed que indica si los resultados son con repetición o no.

* Permutations: Esta función tambien crea una matriz pero con las posibles permutaciones del vector y se usa asi

```{r}
permutations(3, 2, v = 1:3)
```

las entradas son las mismas que en combinations.

### Ejercicio 4

Calcule:

#### La cantidad de permutaciones posibles con n = 11 y r = 3 y sin repetición

```{r}
permutaciones = permutations(11, 3, v = 1:11)
nrow(permutaciones)
```

#### Las combinaciones de largo tres con las letras a, b, c, d y e con y sin repetición

```{r}
combinaciones_r = combinations(5, 3, v = c('a', 'b', 'c', 'd', 'e'), repeats.allowed = TRUE)
nrow(combinaciones_r)
combinaciones = combinations(5, 3, v = c('a', 'b', 'c', 'd', 'e'))
nrow(combinaciones)
```

#### La cantidad de permutaciones y combinaciones con n = 39 y r = 25 y sin repetición
El uso de las funciones permutations y combinations, no logra calcular la cantidad, por lo que se utilizan las formulas
```{r}
permutacion = factorial(39)/(factorial(39-25))
permutacion
combinacion = factorial(39)/(factorial(39-25)*factorial(25))
combinacion
```

### Ejercicio 5
Considere un problema de una vendedora viajera que debe recorrer 50 ciudades y volver al origen sin pasar dos veces por la misma ciudad. Considerando que solo existe una ruta óptima, si se selecciona una ruta al azar

* #### ¿Cuál es la probabilidad de que sea la ruta óptima?

la formula de que la ruta sea optima esta representada por:
\[Probabilidad = \frac{1}{n° casos}\]
\[n° casos = permutaciones\]
como la cantidad de posibilidades es demasiado grande para la funcion permutations se usa la formula
```{r}
permutacion = factorial(50)/factorial(50-50)
probabilidad = 1/permutacion
probabilidad
```

* #### Si se selecciona una ruta al azar que es distinta a la anterior ¿Cuál es la probabilidad de que sea la ruta óptima?

La probabilidad viene dada por \[1/(permutaciones - 1)\] por lo que seria
```{r}
probabilidad = 1/(permutacion-1)
probabilidad
```

Para este problema las funciones combinations y permutations no funcionan dada la magnitud de los vectores a trabajar, dado que se generan matrices el tamaño de estas es demasiado grande para calcular.

### Ejercicio 6
Una bencinera tiene 5 funcionarios que deben limpiar el parabrisas de cada cliente que es atendido. Janet da servicio al 10 % de los clientes y no limpia 1 de cada 20 parabrisas; Tomás da servicio al 60 % de los clientes y no limpia 1 de cada 10 parabrisas; Georgina da servicio al 15 % de los clientes y no limpia 1 de cada 10 parabrisas; Pedro da servicio al 5 % de los clientes y no limpia 1 de cada 20 parabrisas; Marcela da servicio al 10 % de los clientes y no limpia 3 de cada 5 parabrisas. Si un cliente envía una nota de agradecimiento porque su parabrisas quedó como nuevo.

* Exprese la ecuación con la que se puede resolver el problema.

La ecuación con la que se puede resolver el problema es el teorema de Bayes:
\[P(A_n|B) = \frac{P(B|A_n)P(A_n)}{\sum^k_{i=1} P(B|A_i)P(A_i)}\]

* ¿Cuál es la probabilidad de que haya sido atendido por Pedro?

Para saber la probabilidad de que un cliente haya sido atentido por Pedro, se debe condicionar con que el parabrisas este limpio y se representa por
\[P(Pedro|L) = \frac{P(L|Pe)P(Pe)}{P(L)}\]
Se necesita obtener P(L) para calcularlo y P(L) se obtiene de
\[P(L) = P(Pe)P(L|Pe)+P(Ja)P(L|Ja)+P(To)P(L|To)+P(Geo)P(L|Geo)+P(Ma)P(L|Ma)\]

```{r}
p_l = (0.6*0.9)+(0.15*0.9)+(0.05*0.95)+(0.1*0.4)+(0.1*0.95)
p_l
```

entonces la probabilidad de que un cliente sea atentido por Pedro es:
\[P(Pe|L) = \frac{0.95*0.05}{0.8575}\]
```{r}
p_pe = (0.05*0.95)/p_l
p_pe
```


* ¿Cuál es la probabilidad de que haya sido atendido por Janet o Georgina?

Esta probablidad se obtiene de
\[P(Geo \cup Ja |L) = \frac{P(Geo)P(L|Geo)}{P(L)}+\frac{P(Ja)P(L|Ja)}{P(L)}\]
lo que da como resultado
```{r}
p_geo = (0.15*0.90)/p_l
p_ja = (0.1*0.95)/p_l
p_geoUja = p_geo + p_ja
p_geoUja
```

* Calcule la probabilidad de que haya sido atendido por Janet, Georgina, Tomás,Pedro o Marcela. ¿Qué se puede observar?

La probabilidad de que haya sido atentido por cualquiera de los trabajadores es
\[P(Geo \cup Ja \cup Pe \cup Ma \cup To |L) = \frac{P(Geo)P(L|Geo)}{P(L)}+\frac{P(Ja)P(L|Ja)}{P(L)}+\frac{P(Pe)P(L|Pe)}{P(L)}+\frac{P(Ma)P(L|Ma)}{P(L)}+\frac{P(To)P(L|To)}{P(L)}\]
que queda
```{r}
p_ma = (0.1*0.4)/p_l
p_to = (0.6*0.9)/p_l
p_todos = p_ma + p_to + p_geo + p_pe + p_ja
p_todos
```
se observa que da como resultado 1, lo que quiere decir que siempre sera uno de estos cinco quien haya limpiado un parabrisa, ya que conforman el total de trabajadores.

### Ejercicio 7

De un grupo de 40 personas se quiere saber la opinión de 3 personas (seleccionadas al azar) acerca del apruebo o rechazo de la nueva constitución. Si se sabe que 22 personas aprueban y 18 rechazan ¿cuál es la probabilidad de que las tres personas seleccionadas rechacen?

```{r}
p_3r = (18/40)*(17/39)*(16/38)
p_3r
```